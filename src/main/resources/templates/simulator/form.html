<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout">
<head>
<title>Valuarte</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"/>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"/>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css"/>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
</head>
<body>
<div class="container-fluid">
  <div>
    <h3>Simulación de crédito</h3>
    <div th:if="${error}">
      <p th:each="er : ${error}">
      <p th:text="${er}" align="center" />
      </p>
    </div>
    <div th:if="${simulatorCommand.saved}">
      <span style="color:white">El ejercicio del simulador ha sido salvado</span>
    </div>
    <form id="simulator" action="#" th:object="${simulatorCommand}" method="post" >
      <div class="col-md-12">
        <div class="col-xs-6 col-md-4">
          <label>RFC:</label>
          <input type="text" th:field="*{rfc}"/>
          <button type="button" id="search">Buscar</button>
        </div>
        <div class="col-xs-6 col-md-4">
          <label>Nombre:</label>
          <input type="text" th:field="*{nombre}"/>
        </div>
        <div class="col-xs-6 col-md-4">
          <label>Apellido Paterno:</label>
          <input type="text" th:field="*{apellidoPaterno}"/>
        </div>
        <hr />
        <div class="col-xs-6 col-md-4">
          <label>Apellido Materno:</label>
          <input type="text" th:field="*{apellidoMaterno}"/>
        </div>
        <div class="col-xs-6 col-md-4">
          <select name="source">
            <option th:each="source : ${sources}" th:value="${source.id}" th:text="${source.name}"></option>
          </select>
        </div>
      </div>
      <h3>Condiciones de crédito</h3>
      <div class="col-md-12">
        <div class="col-xs-6 col-md-4">
          <label>Total del Crédito:</label>
          <input type="text" th:field="*{loan}"/>
        </div>
        <div class="col-xs-6 col-md-4">
          <label>Tasa de Interés Anualizada:</label>
          <input type="text" th:field="*{tia}"/>
        </div>
        <div class="col-xs-6 col-md-4">
          <label>Comisión por Apertura:</label>
          <input type="text" th:field="*{commission}"/>
        </div>
      </div>
      <div>
        <div class="col-xs-6 col-md-3">
          <label>IVA:</label>
          <input type="text" th:field="*{iva}"/>
        </div>
        <div class="col-xs-6 col-md-3">
          <select  name="paymentPeriod" th:field="*{paymentPeriod}">
            <option th:each="period : ${T(com.team.one.domain.PaymentPeriod).values()}" th:value="${period}" th:text="${period.label}"></option>
          </select>
        </div>
        <div class="col-xs-6 col-md-3">
          <label>Número de Pagos:</label>
          <input type="text" th:field="*{numberOfPayments}"/>
        </div>
        <div class="col-xs-6 col-md-3">
          <label for="datepicker">Fecha de Inicio:</label>
          <input type="text" class="datepicker" th:field="*{startDate}" />
        </div>
      </div>
      <div class="col-md-12">
        <div class="col-xs-6 col-md-4">
        <button id="restructure" type="submit" name="type" th:field="*{type}" value="RESTRUCTURE" >
          Mostrar Reestructura <i >restructure</i>
        </button>
        </div>
      <div class="col-xs-6 col-md-4">
        <button id="valuarte" type="submit" name="type" th:field="*{type}" value="VALUARTE" >
          Mostrar Valuarte <i >valuarte</i>
        </button>
      </div>
      <div class="col-xs-6 col-md-4">
        <button id="save" type="submit" name="saved" th:field="*{saved}" value="true" >
          Guardar la simulación <i >save</i>
        </button>
      </div>
      </div>
    </form>
  </div>

  <div th:if="${detailOfPayments} != null">
    <h3>Resultados de la simulación</h3>
    <h6>Seguro de vida y desempleo: <strong th:text="${beans.currencyFormatter.format(simulator.lifeInsurance)}"></strong></h6>
    <table class="table-striped">
      <thead>
        <tr>
          <div>
            <th class="text-center" data-field="id">#</th>
            <th class="text-center" data-field="capitalBeforePayment">Antes de Pago</th>
            <th class="text-center" data-field="capital">Capital</th>
            <th class="text-center" data-field="interest">Interés</th>
            <th class="text-center" data-field="payment">Pago</th>
            <th class="text-center" data-field="iva">IVA</th>
            <th class="text-center" data-field="capitalAfterPayment">Después de Pago</th>
            <th class="text-center" data-field="paymentDate">Fecha de Pago</th>
            <th class="text-center" data-field="ratio">Proporción</th>
            <th class="text-center" data-field="reward">Recompensa</th>
            <th class="text-center" data-field="profit" style="display:none;">Utilidad</th>
            <th class="text-center" data-field="capitalCut" style="display:none;">A. Capital</th>
            <th class="text-center" data-field="balance" style="display:none;">S. Cartera</th>
            <th class="text-center" data-field="insurance">Seguros</th>
          </div>
        </tr>
      </thead>

      <tbody>
        <div class="valign-wrapper">
          <tr th:each="detailOfPayment : ${detailOfPayments}">
            <td class="text-right" th:text="${detailOfPayment.number}">Number</td>
            <td class="text-right" th:text="${beans.currencyFormatter.format(detailOfPayment.capitalBeforePayment)}">CapitalBeforePayment</td>
            <td class="text-right" th:text="${beans.currencyFormatter.format(detailOfPayment.capital)}">Capital</td>
            <td class="text-right" th:text="${beans.currencyFormatter.format(detailOfPayment.interest)}">Interest</td>
            <td class="text-right" th:text="${beans.currencyFormatter.format(simulator.payment)}">Payment</td>
            <td class="text-right" th:text="${beans.currencyFormatter.format(detailOfPayment.iva)}">IVA</td>
            <td class="text-right" th:text="${beans.currencyFormatter.format(detailOfPayment.capitalAfterPayment)}">CapitalAfterPayment</td>
            <td class="text-center" th:text="${beans.dateFormatter.format(detailOfPayment.paymentDate)}">PaymentDate</td>
            <td class="text-right" th:text="${beans.numberFormatter.format(detailOfPayment.ratio)}">Ratio</td>
            <td class="text-right" th:text="${beans.currencyFormatter.format(detailOfPayment.reward)}">Reward</td>
            <td class="text-right" th:text="${beans.currencyFormatter.format(detailOfPayment.profit)}" style="display:none;">Pofit</td>
            <td class="text-right" th:text="${beans.currencyFormatter.format(detailOfPayment.capitalCut)}" style="display:none;">CapitalCut</td>
            <td class="text-right" th:text="${beans.currencyFormatter.format(detailOfPayment.balance)}" style="display:none;">Balance</td>
            <td class="text-right" th:text="${beans.currencyFormatter.format(detailOfPayment.insurance)}">Insurance</td>
          </tr>
          <tr>
            <div style="font-weight:bold;">
              <td></td>
              <td></td>
              <td class="text-right" th:text="${beans.currencyFormatter.format(totalCapital)}">Total Capital</td>
              <td class="text-right" th:text="${beans.currencyFormatter.format(totalInterest)}">Total Interés</td>
              <td class="text-right" th:text="${beans.currencyFormatter.format(totalPayment)}">Total Pago</td>
              <td class="text-right" th:text="${beans.currencyFormatter.format(totalIVA)}">Total IVA</td>
              <td></td>
              <td></td>
              <td class="text-right" th:text="${beans.numberFormatter.format(totalRatio)}">Total Proporción</td>
              <td class="text-right" th:text="${beans.currencyFormatter.format(totalReward)}">Total Recompensa</td>
              <td class="text-right" th:text="${beans.currencyFormatter.format(totalProfit)}" style="display:none;">Total Utilidad</td>
              <td class="text-right" th:text="${beans.currencyFormatter.format(totalCapitalCut)}" style="display:none;">Total Aplicación de Capital</td>
              <td class="text-right" th:text="${beans.currencyFormatter.format(totalInsurance)}">Total Seguros</td>
            </div>
          </tr>
        </div>
      </tbody>
    </table>
  </div>
</div>
<script src="../../js/simulator/ajax.js" th:src="@{/js/simulator/ajax.js}"></script>
</body>
</html>
